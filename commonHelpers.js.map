{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import Axios from \"axios\";\nimport showErrorMessage from \"../main\";\n\n\nexport const numberOfImagesPerPage = 15;\n\nconst specificAxios = Axios.create({\n    baseURL: 'https://pixabay.com/api/',\n    params: { \n        key: '42121047-6dc093e186e55c34fb150394f',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n    }\n});\n\nasync function getImageGallery(whatAreWeSearching, pageNumber) {\n    try {\n        const response = await specificAxios.get('', {\n            params: {\n                q: whatAreWeSearching,\n                page: pageNumber,\n                per_page: numberOfImagesPerPage,\n            }\n        });\n        return response.data; \n    } catch (error) {\n        showErrorMessage(error);\n        throw error;\n    }\n}\n\nexport default getImageGallery;\n","\nimport { ref } from \"../main.js\";\n\nexport default function renderImageGallery(images) {\n    const markup = createImageCardMarkup(images);\n    ref.formForImagesGallery.insertAdjacentHTML('beforeend',markup);\n   \n}\n\nfunction createImageCardMarkup(images) {\n  return images.map(({ webformatURL, largeImageURL, tags,likes, views, comments,downloads }) => {\n    return `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n          </a>\n        <ul class=\"image-activity\">\n          <li class=\"image-activity-item\">\n            <h4 class=\"image-activity-type\">Likes</h4>\n            <p>${likes}</p>\n          </li>\n          <li class=\"image-activity-item\">\n            <h4 class=\"image-activity-type\">Views</h4>\n            <p>${views}</p>\n          </li>\n          <li class=\"image-activity-item\">\n            <h4 class=\"image-activity-type\">Comments</h4>\n            <p>${comments}</p>\n            <li class=\"image-activity-item\">\n            <h4 class=\"image-activity-type\">Downloads</h4>\n            <p>${downloads}</p>\n          </li>\n          </li>\n        </ul>\n      </li>`\n  }).join('');\n};","'use strict';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport getImageGallery from \"./js/pixabay-api\";\nimport renderImageGallery from \"./js/render-function\";\nimport { numberOfImagesPerPage } from \"./js/pixabay-api\";\nexport const ref = {\n    searchingForm: document.querySelector('.input-form'),\n    loaderSign: document.querySelector('.loader-container'),\n    formForImagesGallery: document.querySelector('.gallery'),\n    loadMoreButton: document.querySelector('.loadMore-button'),\n    loadMoreButtonTextContent: document.querySelector('.lmbutton-text-content'),\n    loaderLoadMore: document.querySelector('.loadMore'),\n    observeTarget: document.querySelector('.js-target'),\n    scrollLoader: document.querySelector('.loadMorescroll'),\n    iternalScrollOption: document.querySelector('input[name=\"iternal-scroll\"]'),\n};\n    \nlet totalNumberOfPages = 0;\nlet pageNumber = 1;\nlet searchingTheme = '';\nconst lMTextContent = { initial: 'Load more', onLoad: 'Loading images' };\nlet options = {\n  root: document.querySelector(\"#scrollArea\"),\n  rootMargin: \"0px\",\n  threshold: 1.0,\n};\nasync function onLoadMore() {\n    const data = await getImageGallery(searchingTheme,pageNumber);\n    totalNumberOfPages = Math.ceil(data.total / numberOfImagesPerPage);\n    ref.scrollLoader.classList.add('hide');\n    renderImageGallery(data.hits);\n    lightbox.refresh();\n}\nlet callback = (entries, observer) => {\n    entries.forEach\n        (entry => {\n            if (entry.isIntersecting) {\n                pageNumber = pageNumber + 1;\n                ref.scrollLoader.classList.remove('hide');\n                onLoadMore();\n                ref.imagesGalleryItem = document.querySelector('.gallery-item');\n                let h = 3 * Math.ceil(ref.imagesGalleryItem.getBoundingClientRect().height);\n                window.scrollBy({\n                    top: h,\n                    behavior: 'smooth',\n                });\n                if ( pageNumber>=totalNumberOfPages) {\n                    observer.unobserve(ref.observeTarget);\n                    ref.observeTarget.classList.add('hide');\n                    showinfoMessage();\n                    }\n                 }\n        })\n};\nconst observer = new IntersectionObserver(callback, options);\n\n\nref.searchingForm.addEventListener('submit', onFormSubmit);\nref.loadMoreButton.addEventListener('click', onLoadMoreButtonClick);\n\nfunction showWarningMessage() {\n    iziToast.warning({\n        color: 'red',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topCenter',\n    });\n};\n\nfunction showWarningMessageForEmptyInput() {\n    iziToast.warning({\n        color: 'red',\n    message: 'TYPE SOME WORD/WORDS, PLEASE!',\n    position: 'topCenter',\n    });\n};\n\nfunction showinfoMessage() {\n  iziToast.info({\n      timeout: 3000,\n      message: `We're sorry, but you've reached the end of search results. `,\n      position: 'topCenter',\n    });\n}\n\nfunction deleteImageGalleryMarkup() {\n    ref.formForImagesGallery.innerHTML = '';\n};\n\nfunction showErrorMessage(error) {\n  iziToast.error({\n      timeout: 3000,\n      message: `An error: ${error} occurred while processing your request `,\n      position: 'topCenter',\n    });\n}\n\nasync function onFormSubmit(event) {\n    event.preventDefault();\n    let onIternalScroll = ref.iternalScrollOption.checked ? true : false;\n    totalNumberOfPages = 0;\n    pageNumber = 1;\n    observer.unobserve(ref.observeTarget);\n    if (!ref.observeTarget.classList.contains('hide')) { ref.observeTarget.classList.add('hide'); };\n    if (!ref.loadMoreButton.classList.contains('hide')) { ref.loadMoreButton.classList.add('hide'); };\n    deleteImageGalleryMarkup();\n    ref.loaderSign.classList.remove('hide');\n    ref.loadMoreButton.classList.add('hide');\n    searchingTheme= event.target.elements.query.value;\n    if (searchingTheme.trim() !== '')\n       {\n        const data = await getImageGallery(searchingTheme,pageNumber);\n        if (data.hits == 0)\n          {\n          ref.loaderSign.classList.add('hide');\n          showWarningMessage();\n         }\n        else\n        {\n        ref.loaderSign.classList.add('hide');\n        renderImageGallery(data.hits);\n        lightbox.refresh();\n        totalNumberOfPages = Math.ceil(data.total / numberOfImagesPerPage);\n         if (totalNumberOfPages > 1)\n          {\n             if (onIternalScroll) {\n                 ref.observeTarget.classList.remove('hide');\n                 observer.observe(ref.observeTarget);\n             }\n             else\n             {\n                 ref.loadMoreButton.classList.remove('hide');\n             }\n          }\n        } \n        ref.searchingForm.reset()\n       }\n    else\n    {\n    ref.loaderSign.classList.add('hide');\n    showWarningMessageForEmptyInput();\n    }\n};\n\nasync function onLoadMoreButtonClick()\n{\n    pageNumber = pageNumber + 1;\n    ref.loaderLoadMore.classList.remove('hide');\n    ref.loadMoreButton.setAttribute('disabled', \"true\");\n    ref.loadMoreButtonTextContent.textContent = lMTextContent.onLoad;\n    const data = await getImageGallery(searchingTheme,pageNumber);\n    totalNumberOfPages = Math.ceil(data.total / numberOfImagesPerPage);\n    ref.loaderLoadMore.classList.add('hide');\n    renderImageGallery(data.hits);\n    lightbox.refresh();\n    ref.imagesGalleryItem = document.querySelector('.gallery-item');\n    let h = 3*Math.ceil(ref.imagesGalleryItem.getBoundingClientRect().height);\n    window.scrollBy\n        ({\n        top: h,\n        behavior: 'smooth',\n        });\n    console.log(totalNumberOfPages);\n    console.log(pageNumber);\n    if (totalNumberOfPages > pageNumber)\n    {\n        ref.loadMoreButton.removeAttribute('disabled');\n        ref.loadMoreButtonTextContent.textContent=lMTextContent.initial;\n    }\n    else\n    {\n        ref.loadMoreButton.classList.add('hide');\n        showinfoMessage();\n    }\n}\n\nlet lightbox = new SimpleLightbox('.gallery a',\n    {\n    captionsData: 'alt', captionDelay: 250,\n    }\n);\nexport default showErrorMessage"],"names":["numberOfImagesPerPage","specificAxios","Axios","getImageGallery","whatAreWeSearching","pageNumber","error","showErrorMessage","renderImageGallery","images","markup","createImageCardMarkup","ref","webformatURL","largeImageURL","tags","likes","views","comments","downloads","totalNumberOfPages","searchingTheme","lMTextContent","options","onLoadMore","data","lightbox","callback","entries","observer","entry","h","showinfoMessage","onFormSubmit","onLoadMoreButtonClick","showWarningMessage","iziToast","showWarningMessageForEmptyInput","deleteImageGalleryMarkup","event","onIternalScroll","SimpleLightbox"],"mappings":"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"}